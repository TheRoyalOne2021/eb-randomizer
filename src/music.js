import importAll from 'import-all.macro';
const urls = importAll.sync('./music/**');

export const customSongs = [
    {
        title: "Bonetrousle",
        artist: "Cover by D-Man",
        instruments: [0x05, 0x54],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Battle Against a Funky Foe",
        artist: "D-Man",
        instruments: [0x05, 0x4a],
    },
    {
        title: "Song 51",
        artist: "D-Man",
        instruments: [0x05, 0x5c],
    },
    {
        title: "Song 48",
        artist: "D-Man",
        instruments: [0x05, 0x59],
    },
    {
        title: "Song 47",
        artist: "D-Man",
        instruments: [0x05, 0x18],
    },
    {
        title: "Song 40",
        artist: "D-Man",
        instruments: [0x05, 0x21],
    },
    {
        title: "Song 39",
        artist: "D-Man",
        instruments: [0x05, 0x21],
    },
    {
        title: "Song 38",
        artist: "D-Man",
        instruments: [0x05, 0x7c],
    },
    {
        title: "Town6",
        artist: "D-Man",
        instruments: [0x05, 0x21],
    },
    {
        title: "Song 36",
        artist: "D-Man",
        instruments: [0x05, 0x40],
    },
    {
        title: "Song 35",
        artist: "D-Man",
        instruments: [0x05, 0x2f],
    },
    {
        title: "Song 34",
        artist: "D-Man",
        instruments: [0x05, 0x18],
    },
    {
        title: "Song 33",
        artist: "D-Man",
        instruments: [0x05, 0x18],
    },
    {
        title: "Song 32",
        artist: "D-Man",
        instruments: [0x05, 0x18],
    },
    {
        title: "Song 31",
        artist: "D-Man",
        instruments: [0x05, 0x08],
    },
    {
        title: "Song 27",
        artist: "D-Man",
        instruments: [0x05, 0x40],
    },
    {
        title: "Song 26",
        artist: "D-Man",
        instruments: [0x05, 0x34],
    },
    {
        title: "Town6",
        artist: "D-Man",
        instruments: [0x05, 0x2F],
    },
    {
        title: "Song 24",
        artist: "D-Man",
        instruments: [0x05, 0x54],
    },
    {
        title: "Song 22",
        artist: "D-Man",
        instruments: [0x05, 0x40],
    },
    {
        title: "Dark Bowser",
        artist: "Cover by D-Man",
        instruments: [0x05, 0x40],
    },
    {
        title: "Song 21",
        artist: "D-Man",
        instruments: [0x05, 0x34],
    },
    {
        title: "Song 20",
        artist: "D-Man",
        instruments: [0x05, 0x34],
        isOverworld: true,
        isBattle: false,
        isBoss: false,
    },
    {
        title: "Song 19",
        artist: "D-Man",
        instruments: [0x05, 0x40],
    },
    {
        title: "Home Guitar Version",
        artist: "Cover by D-Man",
        instruments: [0x05, 0x34],
    },
    {
        title: "Home Music Box Version",
        artist: "Cover by D-Man",
        instruments: [0x05, 0x18],
    },
    {
        title: "Town4",
        artist: "D-Man",
        instruments: [0x05, 0x18],
    },
    {
        title: "Town4s Night",
        artist: "D-Man",
        instruments: [0x05, 0x18],
    },
    {
        title: "A House Theme",
        artist: "vince94",
        instruments: [0x05, 0xa7],
        isOverworld: true,
        isBattle: true,
        isBoss: false,
    },
    {
        title: "Bacon Flavored",
        artist: "Cover by vince94",
        instruments: [0x05, 0x40],
        isOverworld: true,
        isBattle: true,
        isBoss: false,
    },
    {
        title: "Battle with a Dangerous Foe",
        artist: "vince94",
        instruments: [0x05, 0x54],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Battle With a Flippant Foe",
        artist: "vince94",
        instruments: [0x05, 0x76],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Brinstar Red Soil",
        artist: "Cover by vince94",
        instruments: [0x05, 0x32],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Beginning",
        artist: "Cover by vince94",
        instruments: [0x05, 0x32],
        isOverworld: true,
        isBattle: false,
        isBoss: false,
    },
    {
        title: "Susie",
        artist: "Cover by vince94",
        instruments: [0x05, 0x32],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Friendliness",
        artist: "Cover by vince94",
        instruments: [0x05, 0x08],
        isOverworld: true,
        isBattle: true,
        isBoss: false,
    },
    {
        title: "Megalovania",
        artist: "Cover by vince94",
        instruments: [0x05, 0x7c],
        isOverworld: false,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Moonsong",
        artist: "Cover by vince94",
        instruments: [0x05, 0x23],
        isOverworld: true,
        isBattle: false,
        isBoss: false,
    },
    {
        title: "Ruins",
        artist: "Cover by vince94",
        instruments: [0x05, 0x15],
        isOverworld: true,
        isBattle: false,
        isBoss: false,
    },
    {
        title: "Summers Plaza",
        artist: "Cover by vince94",
        instruments: [0x05, 0x08],
        isOverworld: true,
        isBattle: false,
        isBoss: false,
    },
    {
        title: "The Battle of Lil Slugger",
        artist: "Cover by vince94",
        instruments: [0x05, 0x7A],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "The High Sign",
        artist: "vince94",
        instruments: [0x05, 0x08],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Time Trax Music 02",
        artist: "Cover by vince94",
        instruments: [0x05, 0x7C],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Casino Night Zone",
        artist: "Cover by vince94",
        instruments: [0x05, 0x08],
        isOverworld: true,
        isBattle: true,
        isBoss: false,
    },
    {
        title: "Not Alike",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x15],
        isOverworld: true,
        isBattle: true,
        isBoss: false,
    },
    {
        title: "Grandiose Foe",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x7C],
        isOverworld: false,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Akira Volume",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x54],
        isOverworld: false,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "SMT Chaos",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x40],
        isOverworld: true,
        isBattle: false,
        isBoss: false,
    },
    {
        title: "SMT Nocturne Fierce Battle",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x7c],
        isOverworld: false,
        isBattle: false,
        isBoss: true,
    },
    {
        title: "SMT II Chaos",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x40],
        isOverworld: false,
        isBattle: false,
        isBoss: true,
    },
    {
        title: "SMT II 3D Valhalla",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x6e],
        isOverworld: false,
        isBattle: true,
        isBoss: false,
    },
    {
        title: "I'll Face Myself",
        filename: "I_ll_Face_Myself",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x6e],
        isOverworld: false,
        isBattle: false,
        isBoss: true,
    },
    {
        title: "Kazuya Volume",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x7c],
        isOverworld: true,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Say Face D-Mix",
        artist: "Ari3s and D-Man",
        instruments: [0x05, 0x08],
        isOverworld: false,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Battle with Magus",
        artist: "Cover by Ari3s",
        instruments: [0x05, 0x40],
        isOverworld: false,
        isBattle: false,
        isBoss: true,
    },
    {
        title: "Battle Against a Gatekeeper",
        artist: "Ari3s",
        instruments: [0x05, 0x7C],
        isOverworld: false,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Requiem for the Champions",
        artist: "Ari3s",
        instruments: [0x05, 0x7C],
        isOverworld: false,
        isBattle: true,
        isBoss: true,
    },
    {
        title: "Terminal Velocity",
        artist: "Ari3s",
        instruments: [0x05, 0x7C],
        isOverworld: false,
        isBattle: true,
        isBoss: true,
    },
];

export async function prepareCustomSongIndex(index) {
    if(index >= customSongs.length) {
        throw new Error(`Invalid custom song index.`);
    }
    const song = customSongs[index];
    return await prepareCustomSong(song);
}

export async function prepareCustomSong(song) {
    let url = urls[`./music/${song.filename || song.title.replace(/ /g, '_')}.ebm`];
    if(!url) {
        url = urls[`./music/${song.title}.ebm`];
    }
    if(!url) {
        throw new Error(`Could not find music ebm file for ${song.title}.`);
    }
    let response = await fetch(url);
    let buffer = await response.arrayBuffer();
    let data = new Uint8Array(buffer);

    if(data.length < 4) {
        throw new Error(`Invalid song data length.`);
    }
    const songAddress = data.slice(2, 4);
    return Object.assign({ data, songAddress }, song);
}